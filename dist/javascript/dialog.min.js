const dialog={open:{html:function(n,t=false){if(!n){console.error("Could not open dialog (no html).");return}dialog.master.create();dialog.master.setHtml(n);dialog.master.showModal();dialog.master.focusOnCloseButton(t)},element:function(n,t=false){let i=document.querySelector(n);if(!i){console.error("Could not open dialog (element not found).");return}i.nodeName==="DIALOG"&&document.getElementById(dialog.master.id)!==null&&document.getElementById(dialog.master.id).contains(i)===!1?(dialog.master.close(),dialog.other.prepare(i),i.showModal(),dialog.other.focusOnCloseButton(i,t)):(dialog.master.create(),dialog.master.setHtml(i.innerHTML),dialog.master.showModal(),dialog.master.focusOnCloseButton(t))},url:function(n,t=false){dialog.master.create();dialog.master.clear();dialog.master.addLoader();dialog.master.showModal();dialog.master.focusOnCloseButton(t);fetch(n,{headers:{"X-Requested-With":"Fetch"}}).then(n=>n.ok?n.text():Promise.reject(n)).then(i=>{var u=new DOMParser,f=u.parseFromString(i,"text/html"),r=f.querySelector("body");r?dialog.master.setHtml(r.innerHTML):dialog.master.setHtml(i);dialog.master.removeLoader();dialog.master.focusOnCloseButton(t);new RegExp("^(?:[a-z+]+:)?//","i").test(n)===!1&&dialog.master.executeScriptTags()}).catch(()=>{dialog.master.removeLoader(),dialog.master.close(),console.error("Could not load url.")})},fromAttribute:function(n,t=false){if(n&&n.hasAttribute(dialog.settings.attribute)){let i=n.getAttribute(dialog.settings.attribute);i===""&&n.nodeName==="A"&&n.hasAttribute("href")?dialog.open.url(n.getAttribute("href"),t):!i.startsWith("<")&&i.startsWith(".")&&i.indexOf("/")>0||i.startsWith("/")||i.startsWith("http://")||i.startsWith("https://")?dialog.open.url(i,t):/^[a-zA-Z.#]( .|\(.|[\w >:\-\(\)])+$/.test(i)&&document.querySelector(i)!==null?dialog.open.element(i,t):dialog.open.html(i,t)}}},master:{id:"dialog_0",create:function(){if(document.getElementById(dialog.master.id)===null){dialog.master.id="dialog_"+(new Date).getTime();let n=document.createElement("dialog");n.id=dialog.master.id;n.innerHTML=dialog.settings.template;document.body.insertAdjacentElement("beforeend",n);dialog.master.clear();document.getElementById(dialog.master.id).addEventListener("click",function(n){n.target===this&&this.close()});document.getElementById(dialog.master.id).addEventListener("close",function(){dialog.master.clear()})}},clear:function(){dialog.master.setHtml("")},setHtml:function(n){let t=document.querySelector(`#${dialog.master.id}>div>div`);if(t&&(t.innerHTML=n,n!=="")){let i=document.querySelectorAll(`#${dialog.master.id} *[${dialog.settings.attribute}]`);for(var r of i)r.addEventListener("click",function(n){dialog.open.fromAttribute(this,n.detail===0);n.preventDefault()})}},showModal:function(n){(n||(n=document.getElementById(dialog.master.id)),n)&&n.showModal()},addLoader:function(){let n=document.querySelector(`#${dialog.master.id}>div>div`);n&&n.classList.add("loading")},removeLoader:function(){let n=document.querySelector(`#${dialog.master.id}>div>div`);n&&n.classList.remove("loading")},close:function(){let n=document.getElementById(dialog.master.id);n&&n.close()},focusOnCloseButton:function(n){let t=document.querySelector(`#${dialog.master.id} ${n?"button":"form"}`);t&&t.focus()},executeScriptTags:function(){var n,t;let i=document.querySelectorAll(`#${dialog.master.id}>div>div script`);for(n of i)t=document.createElement("script"),n.hasAttribute("src")?t.setAttribute("src",n.getAttribute("src")):t.innerHTML=n.innerHTML,n.remove(),document.querySelector(`#${dialog.master.id}>div>div`).insertAdjacentElement("beforeend",t)}},other:{prepare:function(n){n&&n.getAttribute(`${dialog.settings.attribute}-ready`)===null&&((n.firstElementChild===null||n.firstElementChild.nodeName!=="DIV")&&(n.insertAdjacentHTML("afterbegin",dialog.settings.template),[...n.childNodes].forEach((t,i)=>{i>0&&n.firstElementChild.lastElementChild.appendChild(t)})),n.addEventListener("click",function(n){n.target===this&&this.close()}),n.setAttribute(`${dialog.settings.attribute}-ready`,""))},focusOnCloseButton:function(n,t){let i=n.querySelector(`${t?"button":"form[tabindex]"}`);i&&i.focus()}},settings:{attribute:"data-dialog",template:'<div><form method="dialog" tabindex="0"><button><\/button><\/form><div><\/div><\/div>'}};(function(){let n=document.querySelectorAll(`[${dialog.settings.attribute}]`);for(var t of n)t.addEventListener("click",function(n){dialog.open.fromAttribute(this,n.detail===0);n.preventDefault()})})();